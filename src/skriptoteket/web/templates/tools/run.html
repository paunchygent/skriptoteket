{% extends "base.html" %}
{% block content %}
  <div class="huleedu-panel">
    <div class="huleedu-card">
      <p><a class="huleedu-link" href="/browse">← Tillbaka till katalog</a></p>
      <h2>{{ tool.title }}</h2>
      {% if tool.summary %}
        <p class="huleedu-muted">{{ tool.summary }}</p>
      {% endif %}

      {% if error %}
        <p class="huleedu-error huleedu-mt-2">{{ error }}</p>
      {% endif %}

      <form
        method="post"
        action="/tools/{{ tool.slug }}/run"
        enctype="multipart/form-data"
        hx-post="/tools/{{ tool.slug }}/run"
        hx-target="#result-container"
        hx-swap="innerHTML"
        hx-encoding="multipart/form-data"
        hx-indicator="#run-indicator"
        class="huleedu-stack huleedu-mt-4"
      >
        <div>
          <label for="file" class="huleedu-label">Ladda upp fil</label>
          <label class="huleedu-file-wrapper huleedu-input">
            <span class="huleedu-file-fake-button" aria-hidden="true">Välj fil</span>
            <span id="file-name" class="huleedu-muted huleedu-file-name">Ingen fil vald</span>
            <input
              type="file"
              id="file"
              name="file"
              required
              accept="*/*"
              class="huleedu-file-native"
              data-huleedu-file-name-target="file-name"
            />
          </label>
        </div>
        <div class="huleedu-flex huleedu-gap-4">
          <button type="submit" class="huleedu-btn huleedu-btn-icon huleedu-btn-loading">
            <span id="run-indicator" class="htmx-indicator huleedu-spinner huleedu-spinner-sm huleedu-spinner-light" aria-hidden="true"></span>
            Kör
          </button>
        </div>
      </form>
    </div>

    <div id="result-container" class="huleedu-mt-4">
      {# HTMX will inject run_result.html partial here #}
    </div>
  </div>
{% endblock %}
