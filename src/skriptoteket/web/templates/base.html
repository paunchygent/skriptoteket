<!doctype html>
<html lang="sv">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ title or "Skriptoteket" }}</title>
    {% block head_extra %}{% endblock %}
    <!-- Google Fonts: IBM Plex family -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Serif:wght@400;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- HuleEdu design system -->
    <link rel="stylesheet" href="/static/css/app.css?v={{ static_version }}">
  </head>
  <body class="huleedu-base" hx-boost="true">
    <div class="huleedu-frame">
      <header class="huleedu-header">
        <div class="huleedu-flex-center">
          <a href="/" class="huleedu-header-brand">Skriptoteket</a>
          {% if user %}
            <span class="huleedu-header-separator"></span>
            <nav class="huleedu-header-nav">
              <a href="/browse">Katalog</a>
              {% if user.role != "user" %}
                <a href="/my-tools">Mina verktyg</a>
                <a href="/suggestions/new">Föreslå skript</a>
              {% endif %}
              {% if user.role in ["admin", "superuser"] %}
                <a href="/admin/suggestions">Förslag</a>
                <a href="/admin/tools">Testyta</a>
              {% endif %}
            </nav>
          {% endif %}
        </div>
        {% if user %}
          <button class="huleedu-hamburger"
                  aria-expanded="false"
                  aria-controls="mobile-nav"
                  aria-label="Meny">
            <span></span><span></span><span></span>
          </button>
        {% endif %}
        {% if user %}
        <form method="post" action="/logout" class="huleedu-header-logout">
          <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
          <button type="submit" class="huleedu-btn huleedu-btn-secondary huleedu-btn-sm">Logga ut</button>
        </form>
        {% endif %}
      </header>
      {% if user %}
      <nav id="mobile-nav" class="huleedu-mobile-nav" hidden>
        <a href="/browse">Katalog</a>
        {% if user.role != "user" %}
          <a href="/my-tools">Mina verktyg</a>
          <a href="/suggestions/new">Föreslå skript</a>
        {% endif %}
        {% if user.role in ["admin", "superuser"] %}
          <a href="/admin/suggestions">Förslag</a>
          <a href="/admin/tools">Testyta</a>
        {% endif %}
        <form method="post" action="/logout" class="huleedu-mobile-nav-logout">
          <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
          <button type="submit">Logga ut</button>
        </form>
      </nav>
      {% endif %}
      <main class="{% block main_class %}huleedu-main{% endblock %}">
        {% block content %}{% endblock %}
      </main>
    </div>
    <div id="toast-container" class="huleedu-toast-container">
      {% if request.state.toast_message %}
        <div class="huleedu-toast huleedu-toast-{{ request.state.toast_type or 'success' }}"
             role="alert"
             aria-live="polite"
             data-auto-dismiss="12000">
          <span class="huleedu-toast-icon" aria-hidden="true">
            {% if request.state.toast_type == 'error' %}&#10005;{% else %}&#10003;{% endif %}
          </span>
          <span>{{ request.state.toast_message }}</span>
          <button type="button"
                  class="huleedu-toast-dismiss"
                  aria-label="Stäng">
            &#215;
          </button>
        </div>
      {% endif %}
    </div>
    <script src="/static/js/app.js?v={{ static_version }}" defer></script>
    <script src="/static/vendor/htmx.min.js?v={{ static_version }}" defer></script>
    {% block scripts_extra %}{% endblock %}
  </body>
</html>
