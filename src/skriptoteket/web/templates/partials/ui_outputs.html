{# Shared rendering for stored ui_payload.outputs (contract v2) #}
{% for output in outputs %}
  {% if output.kind == "notice" %}
    <div class="huleedu-alert{% if output.level == 'error' %} huleedu-alert-error{% endif %}">
      {{ output.message }}
    </div>
  {% elif output.kind == "markdown" %}
    <pre>{{ output.markdown }}</pre>
  {% elif output.kind == "table" %}
    {% if output.title %}<strong>{{ output.title }}</strong>{% endif %}
    <div style="overflow:auto;">
      <table class="huleedu-table">
        <thead>
          <tr>
            {% for col in output.columns %}
              <th>{{ col.label }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in output.rows %}
            <tr>
              {% for col in output.columns %}
                <td>{{ row.get(col.key) }}</td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% elif output.kind == "json" %}
    {% if output.title %}<strong>{{ output.title }}</strong>{% endif %}
    <pre>{{ output.value | tojson(indent=2) }}</pre>
  {% elif output.kind == "html_sandboxed" %}
    <iframe
      sandbox
      srcdoc="{{ output.html | e }}"
      style="width: 100%; min-height: 260px; border: var(--huleedu-border-width) solid var(--huleedu-navy); background-color: var(--huleedu-canvas);"
    ></iframe>
  {% endif %}
{% endfor %}
