@import "tailwindcss";
@plugin "@tailwindcss/typography";
@import "../styles/tokens.css";
@import "../styles/tailwind-theme.css";

body {
  background: var(--color-canvas);
  color: var(--color-navy);
}

/* Grid background pattern - 24px baseline grid matching HuleEdu */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image:
    linear-gradient(var(--huleedu-navy) 1px, transparent 1px),
    linear-gradient(90deg, var(--huleedu-navy) 1px, transparent 1px);
  background-size: var(--huleedu-grid-size) var(--huleedu-grid-size);
  opacity: 0.04;
  pointer-events: none;
  z-index: -1;
}

/* ═══════════════════════════════════════════════════════════════════════════
   BUTTON PRIMITIVES - Skriptoteket SPA

   Tailwind v4 note: Cannot @apply custom classes within @layer components.
   Define base styles directly in each button class instead.
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  /* Standard action button: Navy base → Burgundy fill on hover, 4px press */
  .btn-primary {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 text-xs font-bold uppercase tracking-widest select-none;
    @apply border border-navy cursor-pointer transition-colors transition-shadow;
    @apply focus-visible:outline focus-visible:outline-2 focus-visible:outline-burgundy/40 focus-visible:outline-offset-2;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
    @apply bg-navy text-canvas shadow-brutal;
    @apply active:translate-x-1 active:translate-y-1 active:shadow-none;
  }

  /* Critical CTA: Burgundy base, no Navy fill on hover, 4px press */
  .btn-cta {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 text-xs font-bold uppercase tracking-widest select-none;
    @apply border border-navy cursor-pointer transition-colors transition-shadow;
    @apply focus-visible:outline focus-visible:outline-2 focus-visible:outline-burgundy/40 focus-visible:outline-offset-2;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
    @apply bg-burgundy text-canvas shadow-brutal;
    @apply active:translate-x-1 active:translate-y-1 active:shadow-none;
  }

  /* No-fill table/button: Canvas hover + warning highlight, 4px press */
  .btn-ghost {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 text-xs font-bold uppercase tracking-widest select-none;
    @apply border border-navy cursor-pointer transition-colors transition-shadow;
    @apply focus-visible:outline focus-visible:outline-2 focus-visible:outline-burgundy/40 focus-visible:outline-offset-2;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
    @apply bg-white text-navy shadow-brutal;
    @apply active:translate-x-1 active:translate-y-1 active:shadow-none;
  }

  /* ════════════════════════════════════════════════════════════════════════
     TOAST PRIMITIVES - Skriptoteket SPA

     Overlay notifications that do not cause layout shift.
     Variants:
       - info:    navy / 90% + "i" icon (white)
       - success: pine green (`--huleedu-success`) / 90% + check icon (white)
       - warning: amber (`--huleedu-warning`) / 90% + warning icon (navy text for contrast)
       - failure: burgundy / 90% + × icon (white)
     ════════════════════════════════════════════════════════════════════════ */

  .toast-container {
    position: fixed;
    bottom: calc(var(--huleedu-space-4) + env(safe-area-inset-bottom));
    left: 50%;
    transform: translateX(-50%);
    width: min(var(--huleedu-max-width-md), calc(100vw - (2 * var(--huleedu-space-4))));
    z-index: var(--huleedu-z-tooltip);
    pointer-events: none;
  }

  @media (min-width: 768px) {
    .toast-container {
      left: auto;
      transform: none;
      right: var(--huleedu-space-6);
      bottom: var(--huleedu-space-6);
      width: var(--huleedu-max-width-md);
    }
  }

  .toast-stack {
    display: flex;
    flex-direction: column;
    gap: var(--huleedu-space-2);
  }

  .toast {
    @apply pointer-events-auto border border-current shadow-brutal-sm;
    @apply flex items-start gap-3 p-3 text-sm leading-snug;
  }

  .toast-icon {
    @apply mt-0.5 shrink-0;
  }

  .toast-message {
    @apply break-words;
  }

  .toast-close {
    @apply ml-auto -mt-1.5 -mr-1.5 shrink-0;
    @apply w-8 h-8 flex items-center justify-center;
    @apply bg-transparent border-0 p-0;
    @apply text-lg leading-none opacity-80;
    @apply focus-visible:outline focus-visible:outline-2 focus-visible:outline-current focus-visible:outline-offset-2;
  }

  @media (hover: hover) and (pointer: fine) {
    .toast-close:hover {
      @apply opacity-100;
    }
  }

  .toast-info {
    @apply bg-navy/90 text-canvas;
  }

  .toast-success {
    @apply bg-success/90 text-canvas;
  }

  .toast-warning {
    @apply bg-warning/90 text-navy;
  }

  .toast-failure {
    @apply bg-burgundy/90 text-canvas;
  }
}

@media (hover: hover) and (pointer: fine) {
  .btn-primary:not(:disabled):not(:active):hover {
    @apply bg-burgundy;
  }

  .btn-cta:not(:disabled):not(:active):hover {
    @apply ring-2 ring-burgundy/40;
  }

  .btn-ghost:not(:disabled):not(:active):hover {
    @apply bg-canvas ring-2 ring-warning;
  }

  .hover-warning-ring:not(:disabled):not(:active):hover {
    @apply ring-2 ring-warning;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   TOAST TRANSITIONS (Vue TransitionGroup name="toast")
   ═══════════════════════════════════════════════════════════════════════════ */

.toast-enter-active,
.toast-leave-active {
  transition:
    transform var(--huleedu-duration-slow) var(--huleedu-ease-default),
    opacity var(--huleedu-duration-slow) var(--huleedu-ease-default);
}

.toast-enter-from,
.toast-leave-to {
  opacity: 0;
  transform: translateY(12px);
}

@media (min-width: 768px) {
  .toast-enter-from,
  .toast-leave-to {
    transform: translateX(12px);
  }
}

.toast-move {
  transition: transform var(--huleedu-duration-slow) var(--huleedu-ease-default);
}

@media (prefers-reduced-motion: reduce) {
  .toast-enter-active,
  .toast-leave-active,
  .toast-move {
    transition: none;
  }
}
